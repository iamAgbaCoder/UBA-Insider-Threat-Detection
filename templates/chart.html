<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Analysis Results - UBA (User Behaviour Analytics) Insider Threat Detection Software </title>
    <link rel="icon" type="image/ico" href="{{ url_for('static', filename='images/favicon.ico') }}" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bootstrap.min.css') }}"> -->
    <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/fontawesome-all.min.css') }}"> -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/iostyle.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/iotheme29.css') }}">

    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/upload.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- <div class="form"> -->
      <div class="container">
        <div class="iofrm-layout">
          <div class="img-holder">
              <div class="bg"></div>
              <div class="info-holder">
                  <img src="{{ url_for('static', filename='images/graphic3.svg') }}" alt="">
              </div>
          </div>
          <div class="container">
              <h2>Anomaly Detection Results</h2>
              <canvas id="anomaliesChart"></canvas>
              <a href="/" class="btn btn-primary mt-3">Upload Another File</a>
          </div>

          <script>
              document.addEventListener("DOMContentLoaded", function () {
                  let anomaliesData = JSON.parse(localStorage.getItem("anomaliesData")) || [];
                  let timestamps = anomaliesData.map(item => item.timestamp);
                  let scores = anomaliesData.map(item => item.anomaly_score);

                  let ctx = document.getElementById("anomaliesChart").getContext("2d");
                  new Chart(ctx, {
                      type: "line",
                      data: {
                          labels: timestamps,
                          datasets: [{
                              label: "Anomaly Score",
                              data: scores,
                              borderColor: "red",
                              borderWidth: 2,
                              fill: false,
                              pointRadius: 3,
                              pointBackgroundColor: "red"
                          }]
                      },
                      options: {
                          responsive: true,
                          plugins: {
                              title: {
                                  display: true,
                                  text: "Anomaly Scores Over Time"
                              }
                          }
                      }
                  });
              });
          </script>
        </div>
      </div>
      <!-- <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script> -->
      <!-- <script src="{{ url_for('static', filename='js/popper.min.js') }}"></script> -->
      <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
      <!-- <script src="{{ url_for('static', filename='js/upload.js') }}"></script> -->
      <!-- <script src="{{ url_for('static', filename='js/main.js') }}"></script> -->
    <!-- </div> -->
</body>
</html>
